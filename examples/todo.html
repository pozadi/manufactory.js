<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ToDo (Dom-modules example)</title>
  <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.2/underscore-min.js"></script>
  <script src="../dom-modules.js"></script>
  <script src="http://coffeescript.org/extras/coffee-script.js"></script>

  <script type="text/coffeescript">
    module 'Todos', (M) ->
      M.tree """
        .todos
          h1 small / clearButton
          ol / itemList
            li / item dynamic
              [type=checkbox] / itemCheckbox
          form
            [type=text] / newItemText
      """
      M.events """
        submit form add
        change itemCheckbox toggleItem
        click clearButton clear
      """
      M.methods
        template: _.template """
          <li>
            <input type=checkbox> <%= text %>
          </li>
        """
        add: ->
          newItem = $ @template text: @newItemText.val()
          @itemList.append newItem
          @newItemText.val ''
          false
        toggleItem: (checkbox) ->
          item = $(checkbox).parents 'li'
          item.toggleClass 'done', $(checkbox).prop 'checked'
        clear: ->
          @item().filter('.done').remove()
  </script>

  <style type="text/css">
    h1 small {
      cursor: pointer;
      border-bottom: dashed 1px;
      font-weight: normal;
      font-size: 50%;
      vertical-align: middle;
    }
    .done {
      text-decoration: line-through;
      opacity: .5;
    }
  </style>

</head>
<body>
  
  <div class=todos>
    <h1>ToDo <small>Clear completed</small></h1>
    <ol>
      <li>
        <input type=checkbox> Nothing
      </li>
    </ol>
    <form>
      <input type=text placeholder="Good stuff">
      <input type=submit value=Add>
    </form>
  </div>

</body>
</html>